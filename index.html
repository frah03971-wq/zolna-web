<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุฒูููุง - ุณูู ุงูุณูุฏุงู ุงูุฅููุชุฑููู | Zolna Sudan</title>
    <meta name="description" content="ุฃูุจุฑ ุณูู ุฅููุชุฑููู ูู ุงูุณูุฏุงู - ุจูุน ูุงุดุชุฑู ูู ุญุงุฌุชู ุจุฃูุงู ูุน ูุธุงู ุนูููุฉ 2% ููุท">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
    
    <style>
        * { font-family: 'Cairo', sans-serif; }
        
        .gradient-bg { 
            background: linear-gradient(135deg, #059669 0%, #047857 50%, #065f46 100%); 
        }
        
        .gradient-hero {
            background: linear-gradient(135deg, #059669 0%, #047857 50%, #064e3b 100%);
        }
        
        .card-hover { 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
        }
        
        .card-hover:hover { 
            transform: translateY(-8px); 
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); 
        }
        
        .btn-pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }
        
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .bank-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .bankak-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .fawry-card {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <!-- Firebase Config -->
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCx9a7vzp5x0PM6_BurDdfXXhjvJwgbx_U",
            authDomain: "zolna-sd.firebaseapp.com",
            projectId: "zolna-sd",
            storageBucket: "zolna-sd.firebasestorage.app",
            messagingSenderId: "1079282652053",
            appId: "1:1079282652053:web:fd8cb84c19aff096b45c9c",
            measurementId: "G-V2KJ0CVRBX"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
    </script>

    <!-- Navigation -->
    <nav class="gradient-bg text-white sticky top-0 z-50 shadow-2xl">
        <div class="container mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <!-- Logo -->
                <div class="flex items-center space-x-3 space-x-reverse cursor-pointer group" onclick="window.location.href='index.html'">
                    <div class="w-12 h-12 bg-white rounded-full flex items-center justify-center group-hover:scale-110 transition-transform">
                        <span class="text-2xl font-bold text-emerald-600">ุฒ</span>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold tracking-tight">ุฒูููุง</h1>
                        <p class="text-xs text-emerald-100">ูููุง ุฒูู ูุงุญุฏ</p>
                    </div>
                </div>

                <!-- Search Bar (Desktop) -->
                <div class="hidden md:flex flex-1 max-w-xl mx-8">
                    <div class="relative w-full">
                        <input type="text" id="searchInput" placeholder="ุฏูุฑ ุนูู ุฃู ุญุงุฌุฉ... ุณูุงุฑุงุชุ ููุจุงููุงุชุ ุนูุงุฑุงุช" 
                               class="w-full px-6 py-3 rounded-full text-gray-800 outline-none focus:ring-4 focus:ring-emerald-300 text-right shadow-lg">
                        <button onclick="searchProducts()" class="absolute left-2 top-1/2 transform -translate-y-1/2 bg-emerald-600 text-white px-6 py-2 rounded-full hover:bg-emerald-700 transition">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                </div>

                <!-- Buttons -->
                <div class="flex items-center space-x-3 space-x-reverse">
                    <button id="loginBtn" onclick="showLogin()" class="hidden md:block bg-white text-emerald-600 px-6 py-2 rounded-full font-bold hover:bg-gray-100 transition shadow-lg">
                        ุชุณุฌูู ุงูุฏุฎูู
                    </button>
                    <button onclick="goToDashboard()" class="bg-emerald-700 hover:bg-emerald-800 px-5 py-2 rounded-full font-bold transition shadow-lg flex items-center gap-2">
                        <span>๐ค</span>
                        <span class="hidden sm:inline">ุญุณุงุจู</span>
                    </button>
                    <button onclick="showAddProduct()" class="bg-amber-500 hover:bg-amber-600 px-5 py-2 rounded-full font-bold transition shadow-lg btn-pulse flex items-center gap-2">
                        <span>โ</span>
                        <span class="hidden sm:inline">ุฃุถู ุฅุนูุงู</span>
                    </button>
                </div>
            </div>

            <!-- Categories (Desktop) -->
            <div class="hidden md:flex items-center justify-center gap-6 mt-4 pt-4 border-t border-emerald-500/30 text-sm">
                <a href="#" onclick="filterCategory('all')" class="hover:text-amber-300 transition">ุงููู</a>
                <a href="#" onclick="filterCategory('cars')" class="hover:text-amber-300 transition">ุณูุงุฑุงุช</a>
                <a href="#" onclick="filterCategory('phones')" class="hover:text-amber-300 transition">ููุจุงููุงุช</a>
                <a href="#" onclick="filterCategory('electronics')" class="hover:text-amber-300 transition">ุฅููุชุฑูููุงุช</a>
                <a href="#" onclick="filterCategory('furniture')" class="hover:text-amber-300 transition">ุฃุซุงุซ</a>
                <a href="#" onclick="filterCategory('property')" class="hover:text-amber-300 transition">ุนูุงุฑุงุช</a>
                <a href="#" onclick="filterCategory('jobs')" class="hover:text-amber-300 transition">ูุธุงุฆู</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="gradient-hero text-white py-16 md:py-24 relative overflow-hidden">
        <div class="absolute inset-0 opacity-10">
            <div class="absolute top-0 left-0 w-96 h-96 bg-white rounded-full mix-blend-overlay filter blur-3xl transform -translate-x-1/2 -translate-y-1/2"></div>
            <div class="absolute bottom-0 right-0 w-96 h-96 bg-amber-300 rounded-full mix-blend-overlay filter blur-3xl transform translate-x-1/2 translate-y-1/2"></div>
        </div>
        
        <div class="container mx-auto px-4 text-center relative z-10">
            <h2 class="text-4xl md:text-6xl font-bold mb-6 leading-tight">
                ูู ุญุงุฌุชู ูู <span class="text-amber-300 inline-block transform hover:scale-110 transition">ููุงู ูุงุญุฏ</span>
            </h2>
            <p class="text-xl md:text-2xl mb-8 text-emerald-100">ุณููุ ุฎุฏูุงุชุ ูุธุงุฆู... ูููุง ุฒูู ูุงุญุฏ!</p>
            
            <!-- Mobile Search -->
            <div class="md:hidden bg-white rounded-full p-2 flex max-w-lg mx-auto shadow-2xl mb-6">
                <input type="text" id="mobileSearchInput" placeholder="ุฏูุฑ ุนูู ุฃู ุญุงุฌุฉ..." 
                       class="flex-1 px-4 py-3 rounded-full text-gray-800 outline-none text-right text-sm">
                <button onclick="searchProductsMobile()" class="bg-amber-500 text-white px-6 py-3 rounded-full font-bold">
                    <i class="fas fa-search"></i>
                </button>
            </div>

            <!-- Stats -->
            <div class="flex flex-wrap justify-center gap-8 mt-12 text-center">
                <div>
                    <p class="text-3xl font-bold text-amber-300" id="statUsers">0</p>
                    <p class="text-sm text-emerald-100">ูุณุชุฎุฏู</p>
                </div>
                <div>
                    <p class="text-3xl font-bold text-amber-300" id="statProducts">0</p>
                    <p class="text-sm text-emerald-100">ุฅุนูุงู</p>
                </div>
                <div>
                    <p class="text-3xl font-bold text-amber-300" id="statSales">0</p>
                    <p class="text-sm text-emerald-100">ุนูููุฉ ุจูุน</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Commission Info Banner -->
    <div class="bg-amber-100 border-r-4 border-amber-500 p-4 container mx-auto mt-6 rounded-lg shadow-lg flex items-center justify-center gap-3">
        <i class="fas fa-percentage text-amber-600 text-2xl"></i>
        <p class="text-amber-800 font-medium text-center">
            ูุณุจุฉ ุงููููุน <span class="font-bold text-2xl">2%</span> ููุท ุนูู ูู ุนูููุฉ ุจูุน! ุงูุฃูู ูู ุงูุณูุฏุงู ๐ธ๐ฉ
            <a href="#commission-details" class="underline mr-2 hover:text-amber-900">ุงุนุฑู ุฃูุซุฑ</a>
        </p>
    </div>

    <!-- Filters & Sort -->
    <section class="container mx-auto px-4 py-6">
        <div class="bg-white rounded-2xl shadow-lg p-4 flex flex-wrap items-center justify-between gap-4">
            <div class="flex items-center gap-4 overflow-x-auto scrollbar-hide">
                <span class="text-gray-500 whitespace-nowrap">ุชุตููุฉ ุญุณุจ:</span>
                <button onclick="filterCategory('all')" class="px-4 py-2 rounded-full bg-emerald-100 text-emerald-700 font-medium hover:bg-emerald-200 transition whitespace-nowrap">ุงููู</button>
                <button onclick="filterCategory('cars')" class="px-4 py-2 rounded-full bg-gray-100 text-gray-700 font-medium hover:bg-gray-200 transition whitespace-nowrap">๐ ุณูุงุฑุงุช</button>
                <button onclick="filterCategory('phones')" class="px-4 py-2 rounded-full bg-gray-100 text-gray-700 font-medium hover:bg-gray-200 transition whitespace-nowrap">๐ฑ ููุจุงููุงุช</button>
                <button onclick="filterCategory('electronics')" class="px-4 py-2 rounded-full bg-gray-100 text-gray-700 font-medium hover:bg-gray-200 transition whitespace-nowrap">๐ป ุฅููุชุฑูููุงุช</button>
                <button onclick="filterCategory('furniture')" class="px-4 py-2 rounded-full bg-gray-100 text-gray-700 font-medium hover:bg-gray-200 transition whitespace-nowrap">๐ช ุฃุซุงุซ</button>
            </div>
            <div class="flex items-center gap-2">
                <span class="text-gray-500">ุงูุชุฑุชูุจ:</span>
                <select onchange="sortProducts(this.value)" class="px-4 py-2 rounded-lg border border-gray-300 outline-none focus:border-emerald-500">
                    <option value="newest">ุงูุฃุญุฏุซ</option>
                    <option value="price-low">ุงูุณุนุฑ: ูู ุงูุฃูู</option>
                    <option value="price-high">ุงูุณุนุฑ: ูู ุงูุฃุนูู</option>
                </select>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section class="py-12 container mx-auto px-4">
        <div class="flex items-center justify-between mb-8">
            <h3 class="text-3xl font-bold">ุฅุนูุงูุงุช ุญุฏูุซุฉ</h3>
            <a href="#" onclick="showAllProducts()" class="text-emerald-600 hover:text-emerald-700 font-medium">ุนุฑุถ ุงููู <i class="fas fa-arrow-left mr-1"></i></a>
        </div>
        
        <div id="productsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <!-- Products loaded here -->
        </div>

        <!-- Loading State -->
        <div id="loadingState" class="hidden text-center py-12">
            <div class="inline-block animate-spin rounded-full h-12 w-12 border-4 border-emerald-500 border-t-transparent"></div>
            <p class="mt-4 text-gray-500">ุฌุงุฑู ุงูุชุญููู...</p>
        </div>

        <!-- Empty State -->
        <div id="emptyState" class="hidden text-center py-12">
            <i class="fas fa-box-open text-6xl text-gray-300 mb-4"></i>
            <p class="text-gray-500 text-lg">ูุง ุชูุฌุฏ ุฅุนูุงูุงุช ูู ูุฐุง ุงููุณู</p>
            <button onclick="showAddProduct()" class="mt-4 bg-emerald-600 text-white px-6 py-2 rounded-full hover:bg-emerald-700 transition">ุฃุถู ุฅุนูุงู ุงูุขู</button>
        </div>
    </section>

    <!-- Commission Calculator Section -->
    <section id="commission-details" class="bg-emerald-50 py-16">
        <div class="container mx-auto px-4">
            <div class="max-w-4xl mx-auto bg-white rounded-3xl shadow-2xl overflow-hidden">
                <div class="gradient-bg text-white p-8 text-center">
                    <h3 class="text-3xl font-bold mb-2">ุญุงุณุจุฉ ุงูุนูููุฉ</h3>
                    <p class="text-emerald-100">ุงุญุณุจ ูู ูุชุณุชูู ูู ูู ุนูููุฉ ุจูุน</p>
                </div>
                <div class="p-8">
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <label class="block text-gray-700 font-bold mb-2">ุณุนุฑ ุงูููุชุฌ (ุฌููู)</label>
                            <input type="number" id="calcPrice" oninput="calculateCommission()" 
                                   class="w-full px-4 py-3 rounded-xl border-2 border-gray-200 outline-none focus:border-emerald-500 text-2xl font-bold text-center" 
                                   placeholder="100,000">
                        </div>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center p-4 bg-gray-50 rounded-xl">
                                <span class="text-gray-600">ุณุนุฑ ุงูููุชุฌ</span>
                                <span class="font-bold text-xl" id="calcTotal">0 ุฌ</span>
                            </div>
                            <div class="flex justify-between items-center p-4 bg-red-50 rounded-xl text-red-700">
                                <span>ูุณุจุฉ ุฒูููุง (2%)</span>
                                <span class="font-bold text-xl" id="calcCommission">0 ุฌ</span>
                            </div>
                            <div class="flex justify-between items-center p-4 bg-emerald-50 rounded-xl text-emerald-700 border-2 border-emerald-200">
                                <span class="font-bold">ุตุงูู ุฑุจุญู</span>
                                <span class="font-bold text-2xl" id="calcNet">0 ุฌ</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="py-16 container mx-auto px-4">
        <h3 class="text-3xl font-bold text-center mb-12">ููู ุชุฎุชุงุฑ ุฒูููุงุ</h3>
        <div class="grid md:grid-cols-3 gap-8">
            <div class="text-center p-6 rounded-2xl bg-white shadow-lg hover:shadow-xl transition">
                <div class="w-20 h-20 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4 text-4xl">๐</div>
                <h4 class="text-xl font-bold mb-2">ุฃูุงู ุชุงู</h4>
                <p class="text-gray-600">ูุธุงู ุญูุงูุฉ ูุงูู ููุจุงุฆุน ูุงููุดุชุฑู ูุน ุถูุงู ุงุณุชุฑุฌุงุน ุงููููุณ</p>
            </div>
            <div class="text-center p-6 rounded-2xl bg-white shadow-lg hover:shadow-xl transition">
                <div class="w-20 h-20 bg-amber-100 rounded-full flex items-center justify-center mx-auto mb-4 text-4xl">๐ฐ</div>
                <h4 class="text-xl font-bold mb-2">ุฃูู ุนูููุฉ</h4>
                <p class="text-gray-600">2% ููุท! ุงูุฃูู ูู ุงูุณูุฏุงู ููุงุฑูุฉ ุจู 10-20% ูู ุงูููุงูุน ุงูุชุงููุฉ</p>
            </div>
            <div class="text-center p-6 rounded-2xl bg-white shadow-lg hover:shadow-xl transition">
                <div class="w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4 text-4xl">โก</div>
                <h4 class="text-xl font-bold mb-2">ุณุญุจ ุณุฑูุน</h4>
                <p class="text-gray-600">ุงุณุญุจ ูููุณู ูู ููุณ ุงูููู ุนุจุฑ ุจูููุ ููุฑูุ ุฃู ูุงุด</p>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-gray-900 text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid md:grid-cols-4 gap-8 mb-8">
                <div>
                    <h4 class="text-2xl font-bold mb-4 text-emerald-400">ุฒูููุง</h4>
                    <p class="text-gray-400">ุฃูุจุฑ ุณูู ุฅููุชุฑููู ูู ุงูุณูุฏุงูุ ูู ุญุงุฌุชู ูู ููุงู ูุงุญุฏ.</p>
                </div>
                <div>
                    <h5 class="font-bold mb-4">ุฑูุงุจุท ุณุฑูุนุฉ</h5>
                    <ul class="space-y-2 text-gray-400">
                        <li><a href="#" class="hover:text-emerald-400 transition">ุนู ุฒูููุง</a></li>
                        <li><a href="#" class="hover:text-emerald-400 transition">ููููุฉ ุงูุจูุน</a></li>
                        <li><a href="#" class="hover:text-emerald-400 transition">ูุธุงู ุงูุนูููุฉ</a></li>
                        <li><a href="#" class="hover:text-emerald-400 transition">ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ</a></li>
                    </ul>
                </div>
                <div>
                    <h5 class="font-bold mb-4">ุทุฑู ุงูุฏูุน</h5>
                    <div class="flex gap-3 text-2xl">
                        <span title="ุจููู">๐ฆ</span>
                        <span title="ููุฑู">๐ณ</span>
                        <span title="ูุงุด">๐ต</span>
                    </div>
                </div>
                <div>
                    <h5 class="font-bold mb-4">ุชูุงุตู ูุนูุง</h5>
                    <div class="flex gap-4">
                        <a href="#" class="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-emerald-600 transition">
                            <i class="fab fa-whatsapp"></i>
                        </a>
                        <a href="#" class="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-emerald-600 transition">
                            <i class="fab fa-telegram"></i>
                        </a>
                        <a href="#" class="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center hover:bg-emerald-600 transition">
                            <i class="fab fa-facebook"></i>
                        </a>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-800 pt-8 text-center text-gray-500">
                <p>ยฉ 2024 ุฒูููุง - ูููุง ุฒูู ูุงุญุฏ ๐ธ๐ฉ</p>
            </div>
        </div>
    </footer>

    <!-- Add Product Modal -->
    <div id="addProductModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-lg w-full max-h-[90vh] overflow-y-auto">
            <div class="gradient-bg text-white p-6 rounded-t-2xl flex justify-between items-center">
                <h3 class="text-2xl font-bold">ุฅุถุงูุฉ ุฅุนูุงู ุฌุฏูุฏ</h3>
                <button onclick="closeAddProduct()" class="text-white hover:text-gray-200 text-2xl">ร</button>
            </div>
            <form id="addProductForm" onsubmit="submitProduct(event)" class="p-6 space-y-4">
                <div>
                    <label class="block text-gray-700 font-bold mb-2">ุนููุงู ุงูููุชุฌ *</label>
                    <input type="text" id="productTitle" required 
                           class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 outline-none focus:border-emerald-500" 
                           placeholder="ูุซุงู: ุชูููุชุง ููุฑููุง 2019">
                </div>
                
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-gray-700 font-bold mb-2">ุงูุณุนุฑ (ุฌููู) *</label>
                        <input type="number" id="productPrice" required min="1"
                               class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 outline-none focus:border-emerald-500" 
                               placeholder="100000" oninput="updateCommissionPreview()">
                    </div>
                    <div>
                        <label class="block text-gray-700 font-bold mb-2">ุงููุฆุฉ *</label>
                        <select id="productCategory" required class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 outline-none focus:border-emerald-500">
                            <option value="">ุงุฎุชุงุฑ ุงููุฆุฉ</option>
                            <option value="cars">๐ ุณูุงุฑุงุช</option>
                            <option value="phones">๐ฑ ููุจุงููุงุช</option>
                            <option value="electronics">๐ป ุฅููุชุฑูููุงุช</option>
                            <option value="furniture">๐ช ุฃุซุงุซ</option>
                            <option value="property">๐ ุนูุงุฑุงุช</option>
                            <option value="jobs">๐ผ ูุธุงุฆู</option>
                            <option value="other">๐ฆ ุฃุฎุฑู</option>
                        </select>
                    </div>
                </div>

                <!-- Commission Preview -->
                <div class="bg-amber-50 border-r-4 border-amber-500 p-4 rounded-lg">
                    <p class="text-sm text-amber-800 mb-2">ูุนุงููุฉ ุงูุนูููุฉ:</p>
                    <div class="flex justify-between text-sm">
                        <span>ุณุนุฑ ุงูููุชุฌ: <span id="previewPrice" class="font-bold">0</span> ุฌ</span>
                        <span class="text-red-600">ุงูุนูููุฉ (2%): <span id="previewCommission" class="font-bold">0</span> ุฌ</span>
                    </div>
                    <p class="text-emerald-700 font-bold mt-2">ุตุงูู ุฑุจุญู: <span id="previewNet">0</span> ุฌ</p>
                </div>

                <div>
                    <label class="block text-gray-700 font-bold mb-2">ุงููุตู *</label>
                    <textarea id="productDesc" required rows="3"
                              class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 outline-none focus:border-emerald-500" 
                              placeholder="ุงูุชุจ ูุตู ุชูุตููู ููููุชุฌ..."></textarea>
                </div>

                <div>
                    <label class="block text-gray-700 font-bold mb-2">ุฑูู ุงููุงุชู ููุชูุงุตู *</label>
                    <input type="tel" id="sellerPhone" required 
                           class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 outline-none focus:border-emerald-500" 
                           placeholder="ูุซุงู: 0912345678">
                </div>

                <div>
                    <label class="block text-gray-700 font-bold mb-2">ุงููููุน</label>
                    <select id="productLocation" class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 outline-none focus:border-emerald-500">
                        <option value="ุงูุฎุฑุทูู">ุงูุฎุฑุทูู</option>
                        <option value="ุฃู ุฏุฑูุงู">ุฃู ุฏุฑูุงู</option>
                        <option value="ุจุญุฑู">ุจุญุฑู</option>
                        <option value="ูุฏูู">ูุฏูู</option>
                        <option value="ุจูุฑุชุณูุฏุงู">ุจูุฑุชุณูุฏุงู</option>
                        <option value="ุฃุฎุฑู">ุฃุฎุฑู</option>
                    </select>
                </div>

                <div class="flex gap-3 pt-4">
                    <button type="submit" class="flex-1 gradient-bg text-white py-3 rounded-lg font-bold hover:opacity-90 transition">
                        ูุดุฑ ุงูุฅุนูุงู
                    </button>
                    <button type="button" onclick="closeAddProduct()" class="flex-1 bg-gray-200 text-gray-700 py-3 rounded-lg font-bold hover:bg-gray-300 transition">
                        ุฅูุบุงุก
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white rounded-2xl max-w-md w-full p-8 text-center">
            <h3 class="text-2xl font-bold mb-6">ุชุณุฌูู ุงูุฏุฎูู</h3>
            
            <button onclick="loginDemo()" class="w-full bg-emerald-500 text-white py-4 rounded-xl font-bold mb-4 hover:bg-emerald-600 transition flex items-center justify-center gap-3 text-lg">
                <span>๐ค</span>
                ุฏุฎูู ุณุฑูุน (ุจุฏูู ุชุณุฌูู)
            </button>
            
            <div class="relative my-6">
                <div class="absolute inset-0 flex items-center">
                    <div class="w-full border-t border-gray-300"></div>
                </div>
                <div class="relative flex justify-center text-sm">
                    <span class="px-2 bg-white text-gray-500">ุฃู</span>
                </div>
            </div>
            
            <input type="text" id="demoUser" placeholder="ุงูุชุจ ุงุณูู" 
                   class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 outline-none focus:border-emerald-500 mb-4">
            
            <button onclick="loginWithName()" class="w-full bg-amber-500 text-white py-3 rounded-lg font-bold hover:bg-amber-600 transition">
                ุฏุฎูู ุจุงูุงุณู
            </button>
            
            <button onclick="closeLogin()" class="w-full mt-4 text-gray-500 hover:text-gray-700">ุฅูุบุงุก</button>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // Constants
        const COMMISSION_RATE = 0.02;
        const MIN_WITHDRAWAL = 10000;

        // Global Variables
        let currentUser = null;
        let allProducts = [];

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            checkAuth();
            loadProducts();
            updateStats();
        });

        // Auth Functions
        function checkAuth() {
            const user = localStorage.getItem('zolna_user');
            if (user) {
                currentUser = user;
                updateLoginButton(user);
            }
        }

        function showLogin() {
            document.getElementById('loginModal').classList.remove('hidden');
        }

        function closeLogin() {
            document.getElementById('loginModal').classList.add('hidden');
        }

        function loginDemo() {
            const name = 'ุฒุงุฆุฑ_' + Math.floor(Math.random() * 1000);
            completeLogin(name);
        }

        function loginWithName() {
            const name = document.getElementById('demoUser').value.trim();
            if (!name) {
                alert('ูุฑุฌู ุฅุฏุฎุงู ุงุณู');
                return;
            }
            completeLogin(name);
        }

        function completeLogin(name) {
            localStorage.setItem('zolna_user', name);
            currentUser = name;
            updateLoginButton(name);
            closeLogin();
            
            // Save to Firebase
            db.collection('users').doc(name).set({
                name: name,
                joinedAt: new Date(),
                lastLogin: new Date()
            }, { merge: true });
            
            showNotification('ูุฑุญุจุงู ' + name + '! ๐');
        }

        function updateLoginButton(name) {
            const btn = document.getElementById('loginBtn');
            btn.textContent = name;
            btn.onclick = logout;
            btn.classList.remove('hidden');
        }

        function logout() {
            if (confirm('ุชุฃูุฏ ุชุจู ุชุณุฌู ุฎุฑูุฌุ')) {
                localStorage.removeItem('zolna_user');
                currentUser = null;
                location.reload();
            }
        }

        function goToDashboard() {
            if (!currentUser) {
                showLogin();
                return;
            }
            window.location.href = 'dashboard.html';
        }

        // Product Functions
        function showAddProduct() {
            if (!currentUser) {
                showLogin();
                return;
            }
            document.getElementById('addProductModal').classList.remove('hidden');
        }

        function closeAddProduct() {
            document.getElementById('addProductModal').classList.add('hidden');
        }

        function updateCommissionPreview() {
            const price = parseFloat(document.getElementById('productPrice').value) || 0;
            const commission = Math.round(price * COMMISSION_RATE);
            const net = price - commission;
            
            document.getElementById('previewPrice').textContent = price.toLocaleString();
            document.getElementById('previewCommission').textContent = commission.toLocaleString();
            document.getElementById('previewNet').textContent = net.toLocaleString();
        }

        function submitProduct(e) {
            e.preventDefault();
            
            const price = parseFloat(document.getElementById('productPrice').value);
            const commission = Math.round(price * COMMISSION_RATE);
            
            const product = {
                id: Date.now().toString(),
                title: document.getElementById('productTitle').value,
                price: price,
                commission: commission,
                netPrice: price - commission,
                category: document.getElementById('productCategory').value,
                description: document.getElementById('productDesc').value,
                phone: document.getElementById('sellerPhone').value,
                location: document.getElementById('productLocation').value,
                seller: currentUser,
                sellerId: currentUser,
                createdAt: new Date(),
                status: 'active',
                views: 0
            };

            // Save to Firebase
            db.collection('products').doc(product.id).set(product)
                .then(() => {
                    // Save to local
                    let products = JSON.parse(localStorage.getItem('zolna_products') || '[]');
                    products.unshift(product);
                    localStorage.setItem('zolna_products', JSON.stringify(products));
                    
                    closeAddProduct();
                    document.getElementById('addProductForm').reset();
                    loadProducts();
                    showNotification('ุชู ูุดุฑ ุงูุฅุนูุงู ุจูุฌุงุญ! ๐');
                })
                .catch(err => {
                    console.error('Error:', err);
                    // Fallback to local
                    saveProductLocal(product);
                });
        }

        function saveProductLocal(product) {
            let products = JSON.parse(localStorage.getItem('zolna_products') || '[]');
            products.unshift(product);
            localStorage.setItem('zolna_products', JSON.stringify(products));
            
            closeAddProduct();
            document.getElementById('addProductForm').reset();
            loadProducts();
            showNotification('ุชู ุงูุญูุธ ูุญููุงู (Firebase ุบูุฑ ูุชุตู)');
        }

        function loadProducts() {
            const grid = document.getElementById('productsGrid');
            const loading = document.getElementById('loadingState');
            const empty = document.getElementById('emptyState');
            
            loading.classList.remove('hidden');
            grid.innerHTML = '';
            
            // Try Firebase first
            db.collection('products').orderBy('createdAt', 'desc').limit(20).get()
                .then(snapshot => {
                    loading.classList.add('hidden');
                    
                    if (snapshot.empty) {
                        // Load from local or samples
                        loadLocalProducts();
                        return;
                    }
                    
                    allProducts = [];
                    snapshot.forEach(doc => {
                        allProducts.push({ id: doc.id, ...doc.data() });
                    });
                    
                    displayProducts(allProducts);
                })
                .catch(() => {
                    loading.classList.add('hidden');
                    loadLocalProducts();
                });
        }

        function loadLocalProducts() {
            let products = JSON.parse(localStorage.getItem('zolna_products') || '[]');
            
            if (products.length === 0) {
                // Sample products
                products = [
                    {
                        id: '1',
                        title: 'ุชูููุชุง ููุฑููุง 2019',
                        price: 12500000,
                        netPrice: 12250000,
                        category: 'cars',
                        description: 'ุณูุงุฑุฉ ูุธููุฉ ุฌุฏุงูุ ูุงุดูุฉ 50,000 ูู',
                        phone: '0912345678',
                        location: 'ุงูุฎุฑุทูู',
                        seller: 'ุฃุญูุฏ',
                        createdAt: new Date()
                    },
                    {
                        id: '2',
                        title: 'ุขูููู 14 Pro Max',
                        price: 450000,
                        netPrice: 441000,
                        category: 'phones',
                        description: '256GB - ุฌุฏูุฏ ูุน ุงููุฑุชููุฉ',
                        phone: '0998765432',
                        location: 'ุฃู ุฏุฑูุงู',
                        seller: 'ูุญูุฏ',
                        createdAt: new Date()
                    },
                    {
                        id: '3',
                        title: 'ุทูู ุฌููุณ ููุฏุฑู',
                        price: 320000,
                        netPrice: 313600,
                        category: 'furniture',
                        description: '3+2+1+1 - ุฎุดุจ ุฒุงู ุฃุตูู',
                        phone: '0923456789',
                        location: 'ุจุญุฑู',
                        seller: 'ูุงุทูุฉ',
                        createdAt: new Date()
                    },
                    {
                        id: '4',
                        title: 'ุดูุฉ ููุจูุน - ุงูุฑูุงุถ',
                        price: 150000000,
                        netPrice: 147000000,
                        category: 'property',
                        description: '3 ุบุฑูุ ุตุงูุฉุ ูุทุจุฎุ 2 ุญูุงู',
                        phone: '0934567890',
                        location: 'ุงูุฎุฑุทูู',
                        seller: 'ุนูุฑ',
                        createdAt: new Date()
                    }
                ];
                localStorage.setItem('zolna_products', JSON.stringify(products));
            }
            
            allProducts = products;
            displayProducts(products);
        }

        function displayProducts(products) {
            const grid = document.getElementById('productsGrid');
            
            if (products.length === 0) {
                document.getElementById('emptyState').classList.remove('hidden');
                return;
            }
            
            document.getElementById('emptyState').classList.add('hidden');
            
            grid.innerHTML = products.map(p => createProductCard(p)).join('');
        }

        function createProductCard(p) {
            const date = p.createdAt?.toDate ? p.createdAt.toDate().toLocaleDateString('ar-SD') : 
                        (typeof p.createdAt === 'string' ? p.createdAt : 'ุญุฏูุซุงู');
            
            const categoryIcons = {
                cars: '๐',
                phones: '๐ฑ',
                electronics: '๐ป',
                furniture: '๐ช',
                property: '๐',
                jobs: '๐ผ',
                other: '๐ฆ'
            };
            
            return `
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden card-hover fade-in border border-gray-100">
                    <div class="relative">
                        <div class="w-full h-48 bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center">
                            <span class="text-6xl">${categoryIcons[p.category] || '๐ฆ'}</span>
                        </div>
                        <div class="absolute top-3 left-3 bg-emerald-500 text-white px-3 py-1 rounded-full text-xs font-bold">
                            ${categoryIcons[p.category] || ''} ${getCategoryName(p.category)}
                        </div>
                        <div class="absolute top-3 right-3 bg-amber-500 text-white px-3 py-1 rounded-full text-xs font-bold">
                            ${p.location || 'ุงูุฎุฑุทูู'}
                        </div>
                    </div>
                    <div class="p-5">
                        <h4 class="font-bold text-lg mb-2 line-clamp-1">${p.title}</h4>
                        <div class="flex items-baseline gap-2 mb-2">
                            <span class="text-emerald-600 font-bold text-2xl">${p.price?.toLocaleString() || 0} ุฌ</span>
                        </div>
                        <p class="text-xs text-gray-500 mb-3">
                            ุงูุจุงุฆุน ูุณุชูู: <span class="text-emerald-600 font-bold">${p.netPrice?.toLocaleString() || (p.price * 0.98).toLocaleString()} ุฌ</span>
                            <span class="text-red-500">(ุจุนุฏ 2%)</span>
                        </p>
                        <p class="text-gray-600 text-sm mb-4 line-clamp-2">${p.description}</p>
                        <div class="flex items-center justify-between text-sm text-gray-500 mb-4">
                            <span>๐ค ${p.seller}</span>
                            <span>๐ ${date}</span>
                        </div>
                        <button onclick="contactSeller('${p.phone}', '${p.seller}')" 
                                class="w-full bg-emerald-100 text-emerald-700 py-3 rounded-xl font-bold hover:bg-emerald-200 transition flex items-center justify-center gap-2">
                            <span>๐</span>
                            ุชูุงุตู ูุน ุงูุจุงุฆุน
                        </button>
                    </div>
                </div>
            `;
        }

        function getCategoryName(cat) {
            const names = {
                cars: 'ุณูุงุฑุงุช',
                phones: 'ููุจุงููุงุช',
                electronics: 'ุฅููุชุฑูููุงุช',
                furniture: 'ุฃุซุงุซ',
                property: 'ุนูุงุฑุงุช',
                jobs: 'ูุธุงุฆู',
                other: 'ุฃุฎุฑู'
            };
            return names[cat] || cat;
        }

        function contactSeller(phone, seller) {
            if (!currentUser) {
                showLogin();
                return;
            }
            alert(`๐ค ุงูุจุงุฆุน: ${seller}\n๐ ุงูุฑูู: ${phone}\n\n๐ก ูุตูุญุฉ: ุงุชุตู ุงูุขู ุฃู ุงุฑุณู ูุงุชุณุงุจ!`);
        }

        // Search & Filter
        function searchProducts() {
            const query = document.getElementById('searchInput').value.toLowerCase();
            filterAndDisplay(query);
        }

        function searchProductsMobile() {
            const query = document.getElementById('mobileSearchInput').value.toLowerCase();
            filterAndDisplay(query);
        }

        function filterCategory(category) {
            if (category === 'all') {
                displayProducts(allProducts);
            } else {
                const filtered = allProducts.filter(p => p.category === category);
                displayProducts(filtered);
            }
        }

        function filterAndDisplay(query) {
            const filtered = allProducts.filter(p => 
                p.title.toLowerCase().includes(query) || 
                p.description.toLowerCase().includes(query)
            );
            displayProducts(filtered);
        }

        function sortProducts(sortBy) {
            let sorted = [...allProducts];
            
            switch(sortBy) {
                case 'price-low':
                    sorted.sort((a, b) => a.price - b.price);
                    break;
                case 'price-high':
                    sorted.sort((a, b) => b.price - a.price);
                    break;
                case 'newest':
                default:
                    sorted.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
            }
            
            displayProducts(sorted);
        }

        // Commission Calculator
        function calculateCommission() {
            const price = parseFloat(document.getElementById('calcPrice').value) || 0;
            const commission = Math.round(price * COMMISSION_RATE);
            const net = price - commission;
            
            document.getElementById('calcTotal').textContent = price.toLocaleString() + ' ุฌ';
            document.getElementById('calcCommission').textContent = commission.toLocaleString() + ' ุฌ';
            document.getElementById('calcNet').textContent = net.toLocaleString() + ' ุฌ';
        }

        // Stats
        function updateStats() {
            // Animate numbers
            animateNumber('statUsers', 1250);
            animateNumber('statProducts', allProducts.length || 450);
            animateNumber('statSales', 890);
        }

        function animateNumber(id, target) {
            const el = document.getElementById(id);
            let current = 0;
            const increment = target / 50;
            const timer = setInterval(() => {
                current += increment;
                if (current >= target) {
                    current = target;
                    clearInterval(timer);
                }
                el.textContent = Math.floor(current).toLocaleString();
            }, 30);
        }

        // Notification
        function showNotification(message) {
            const div = document.createElement('div');
            div.className = 'fixed top-20 left-1/2 transform -translate-x-1/2 bg-emerald-600 text-white px-6 py-3 rounded-full shadow-2xl z-50 fade-in';
            div.textContent = message;
            document.body.appendChild(div);
            setTimeout(() => div.remove(), 3000);
        }

        function showAllProducts() {
            displayProducts(allProducts);
        }
    </script>

</body>
</html>
