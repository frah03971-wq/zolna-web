<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø­Ø³Ø§Ø¨ÙŠ - Ø²ÙˆÙ„Ù†Ø§</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>* { font-family: 'Cairo', sans-serif; }</style>
</head>
<body class="bg-gray-50">

    <!-- Navigation -->
    <nav class="bg-emerald-600 text-white sticky top-0 z-50 shadow-lg">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center">
                    <span class="text-xl font-bold text-emerald-600">Ø²</span>
                </div>
                <h1 class="text-xl font-bold">Ø­Ø³Ø§Ø¨ÙŠ</h1>
            </div>
            <a href="index.html" class="text-white hover:text-emerald-100">
                <i class="fas fa-home"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            </a>
        </div>
    </nav>

    <div class="container mx-auto px-4 py-8">
        
        <!-- User Info -->
        <div class="bg-white p-6 rounded-2xl shadow mb-6">
            <h2 class="text-2xl font-bold mb-2">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ <span id="userName">Ø²Ø§Ø¦Ø±</span> ğŸ‘‹</h2>
            <p class="text-gray-500">Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨: <span id="accountNumber">-</span></p>
        </div>

        <!-- Stats Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <!-- Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª -->
            <div class="bg-emerald-500 text-white p-6 rounded-2xl">
                <div class="flex justify-between items-start">
                    <div>
                        <h3 class="text-lg mb-2">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</h3>
                        <p class="text-3xl font-bold" id="totalSales">0 Ø¬</p>
                    </div>
                    <i class="fas fa-chart-line text-4xl opacity-50"></i>
                </div>
            </div>

            <!-- ÙÙ„ÙˆØ³ÙŠ (Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ø³Ø¨Ø©) -->
            <div class="bg-amber-500 text-white p-6 rounded-2xl">
                <div class="flex justify-between items-start">
                    <div>
                        <h3 class="text-lg mb-2">Ø±ØµÙŠØ¯ÙŠ Ø§Ù„Ù‚Ø§Ø¨Ù„ Ù„Ù„Ø³Ø­Ø¨</h3>
                        <p class="text-3xl font-bold" id="myEarnings">0 Ø¬</p>
                    </div>
                    <i class="fas fa-wallet text-4xl opacity-50"></i>
                </div>
                <p class="text-sm mt-2 opacity-90">Ø¨Ø¹Ø¯ Ø®ØµÙ… 2% Ù†Ø³Ø¨Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹</p>
            </div>

            <!-- Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª -->
            <div class="bg-blue-500 text-white p-6 rounded-2xl">
                <div class="flex justify-between items-start">
                    <div>
                        <h3 class="text-lg mb-2">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</h3>
                        <p class="text-3xl font-bold" id="salesCount">0</p>
                    </div>
                    <i class="fas fa-shopping-bag text-4xl opacity-50"></i>
                </div>
            </div>
        </div>

        <!-- Commission Details -->
        <div class="bg-white p-6 rounded-2xl shadow mb-8">
            <h3 class="text-xl font-bold mb-4"><i class="fas fa-calculator ml-2"></i>ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù†Ø³Ø¨Ø©</h3>
            <div class="overflow-x-auto">
                <table class="w-full text-right">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="p-3">Ø§Ù„Ø¨Ù†Ø¯</th>
                            <th class="p-3">Ø§Ù„Ù…Ø¨Ù„Øº</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="border-b">
                            <td class="p-3">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</td>
                            <td class="p-3 font-bold" id="detailTotal">0 Ø¬</td>
                        </tr>
                        <tr class="border-b text-red-600">
                            <td class="p-3">Ù†Ø³Ø¨Ø© Ø§Ù„Ù…ÙˆÙ‚Ø¹ (2%)</td>
                            <td class="p-3 font-bold" id="detailCommission">0 Ø¬</td>
                        </tr>
                        <tr class="bg-emerald-50 text-emerald-700">
                            <td class="p-3 font-bold">ØµØ§ÙÙŠ Ø±Ø¨Ø­Ùƒ</td>
                            <td class="p-3 font-bold text-xl" id="detailNet">0 Ø¬</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- My Products -->
        <div class="bg-white p-6 rounded-2xl shadow mb-8">
            <h3 class="text-xl font-bold mb-4"><i class="fas fa-box ml-2"></i>Ù…Ù†ØªØ¬Ø§ØªÙŠ</h3>
            <div id="myProductsList" class="space-y-3">
                <p class="text-gray-500 text-center py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª</p>
            </div>
        </div>

        <!-- Withdrawal Section -->
        <div class="bg-white p-6 rounded-2xl shadow">
            <h3 class="text-xl font-bold mb-4"><i class="fas fa-money-bill-wave ml-2"></i>Ø³Ø­Ø¨ Ø§Ù„ÙÙ„ÙˆØ³</h3>
            
            <div class="bg-amber-50 border-r-4 border-amber-500 p-4 mb-4 rounded">
                <p class="text-amber-800">
                    <i class="fas fa-info-circle ml-2"></i>
                    Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø³Ø­Ø¨: <strong>10,000 Ø¬Ù†ÙŠÙ‡</strong>
                </p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block text-gray-700 mb-2">Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø³Ø­Ø¨</label>
                    <select id="withdrawMethod" class="w-full px-4 py-2 border rounded-lg">
                        <option value="bankak">Ø¨Ù†ÙƒÙƒ (Bankak)</option>
                        <option value="fawry">ÙÙˆØ±ÙŠ (Fawry)</option>
                        <option value="cash">ÙƒØ§Ø´ (Ø§Ø³ØªÙ„Ø§Ù… ÙŠØ¯ Ø¨ÙŠØ¯)</option>
                    </select>
                </div>
                <div>
                    <label class="block text-gray-700 mb-2">Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ / Ø§Ù„Ù‡Ø§ØªÙ</label>
                    <input type="text" id="withdrawAccount" class="w-full px-4 py-2 border rounded-lg" placeholder="Ù…Ø«Ø§Ù„: 0912345678">
                </div>
            </div>

            <div class="mb-4">
                <label class="block text-gray-700 mb-2">Ø§Ù„Ù…Ø¨Ù„Øº (Ø¬Ù†ÙŠÙ‡)</label>
                <input type="number" id="withdrawAmount" class="w-full px-4 py-2 border rounded-lg" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…Ø¨Ù„Øº">
                <p class="text-sm text-gray-500 mt-1">Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­: <span id="availableBalance" class="font-bold text-emerald-600">0</span> Ø¬</p>
            </div>

            <button onclick="requestWithdrawal()" class="bg-emerald-500 hover:bg-emerald-600 text-white px-8 py-3 rounded-lg font-bold transition w-full md:w-auto">
                <i class="fas fa-paper-plane ml-2"></i>Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨
            </button>

            <!-- Withdrawal History -->
            <div class="mt-6">
                <h4 class="font-bold mb-3">Ø³Ø¬Ù„ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø¨</h4>
                <div id="withdrawHistory" class="space-y-2">
                    <p class="text-gray-500 text-sm">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø³Ø­Ø¨</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const COMMISSION_RATE = 0.02;
        const MIN_WITHDRAWAL = 10000;

        // Load user data
        function loadUserData() {
            const user = localStorage.getItem('zolna_user') || 'Ø²Ø§Ø¦Ø±';
            document.getElementById('userName').textContent = user;
            document.getElementById('accountNumber').textContent = 'ZOL-' + Math.random().toString(36).substr(2, 6).toUpperCase();
            
            calculateStats();
            loadMyProducts();
            loadWithdrawHistory();
        }

        // Calculate seller stats
        function calculateStats() {
            const products = JSON.parse(localStorage.getItem('zolna_products') || '[]');
            const myProducts = products.filter(p => p.seller === localStorage.getItem('zolna_user'));
            
            let totalSales = 0;
            myProducts.forEach(p => {
                totalSales += p.price;
            });

            const commission = Math.round(totalSales * COMMISSION_RATE);
            const netEarnings = totalSales - commission;

            // Update UI
            document.getElementById('totalSales').textContent = totalSales.toLocaleString() + ' Ø¬';
            document.getElementById('myEarnings').textContent = netEarnings.toLocaleString() + ' Ø¬';
            document.getElementById('salesCount').textContent = myProducts.length;
            document.getElementById('availableBalance').textContent = netEarnings.toLocaleString();

            // Update details table
            document.getElementById('detailTotal').textContent = totalSales.toLocaleString() + ' Ø¬';
            document.getElementById('detailCommission').textContent = commission.toLocaleString() + ' Ø¬';
            document.getElementById('detailNet').textContent = netEarnings.toLocaleString() + ' Ø¬';

            return netEarnings;
        }

        // Load my products
        function loadMyProducts() {
            const products = JSON.parse(localStorage.getItem('zolna_products') || '[]');
            const myProducts = products.filter(p => p.seller === localStorage.getItem('zolna_user'));
            const list = document.getElementById('myProductsList');

            if (myProducts.length === 0) {
                list.innerHTML = '<p class="text-gray-500 text-center py-4">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ù†ØªØ¬Ø§Øª</p>';
                return;
            }

            list.innerHTML = myProducts.map(p => {
                const net = Math.round(p.price * 0.98);
                return `
                    <div class="flex justify-between items-center p-4 border rounded-lg hover:bg-gray-50">
                        <div>
                            <h4 class="font-bold">${p.title}</h4>
                            <p class="text-sm text-gray-500">${p.createdAt}</p>
                        </div>
                        <div class="text-left">
                            <p class="font-bold text-emerald-600">${p.price.toLocaleString()} Ø¬</p>
                            <p class="text-xs text-gray-500">ØªØ­ØµÙ„: ${net.toLocaleString()} Ø¬</p>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // Request withdrawal
        function requestWithdrawal() {
            const balance = calculateStats();
            const amount = parseFloat(document.getElementById('withdrawAmount').value);
            const method = document.getElementById('withdrawMethod').value;
            const account = document.getElementById('withdrawAccount').value;

            // Validation
            if (!amount || amount < MIN_WITHDRAWAL) {
                alert(`Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰ Ù„Ù„Ø³Ø­Ø¨ Ù‡Ùˆ ${MIN_WITHDRAWAL.toLocaleString()} Ø¬Ù†ÙŠÙ‡`);
                return;
            }

            if (amount > balance) {
                alert('Ø§Ù„Ù…Ø¨Ù„Øº Ø£ÙƒØ¨Ø± Ù…Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­!');
                return;
            }

            if (!account) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ø­Ø³Ø§Ø¨');
                return;
            }

            // Create withdrawal request
            const request = {
                id: Date.now(),
                amount: amount,
                method: method,
                account: account,
                status: 'pending',
                date: new Date().toLocaleString('ar-SD'),
                seller: localStorage.getItem('zolna_user')
            };

            // Save to history
            let history = JSON.parse(localStorage.getItem('zolna_withdrawals') || '[]');
            history.unshift(request);
            localStorage.setItem('zolna_withdrawals', JSON.stringify(history));

            // Deduct from balance (simulation)
            let currentBalance = parseFloat(localStorage.getItem('zolna_balance') || '0');
            localStorage.setItem('zolna_balance', currentBalance - amount);

            alert(`âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø³Ø­Ø¨ Ø¨Ù†Ø¬Ø§Ø­!\n\nØ§Ù„Ù…Ø¨Ù„Øº: ${amount.toLocaleString()} Ø¬\nØ§Ù„Ø·Ø±ÙŠÙ‚Ø©: ${method}\n\nØ³ÙŠØªÙ… Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©.`);

            // Clear form
            document.getElementById('withdrawAmount').value = '';
            document.getElementById('withdrawAccount').value = '';

            loadWithdrawHistory();
            calculateStats();
        }

        // Load withdrawal history
        function loadWithdrawHistory() {
            const history = JSON.parse(localStorage.getItem('zolna_withdrawals') || '[]');
            const container = document.getElementById('withdrawHistory');

            if (history.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-sm">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø³Ø­Ø¨</p>';
                return;
            }

            const statusColors = {
                'pending': 'bg-yellow-100 text-yellow-800',
                'approved': 'bg-emerald-100 text-emerald-800',
                'rejected': 'bg-red-100 text-red-800'
            };

            const statusText = {
                'pending': 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©',
                'approved': 'ØªÙ… Ø§Ù„ØªØ­ÙˆÙŠÙ„',
                'rejected': 'Ù…Ø±ÙÙˆØ¶'
            };

            container.innerHTML = history.map(h => `
                <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                    <div>
                        <p class="font-bold">${h.amount.toLocaleString()} Ø¬</p>
                        <p class="text-xs text-gray-500">${h.method} - ${h.date}</p>
                    </div>
                    <span class="px-3 py-1 rounded-full text-xs ${statusColors[h.status]}">
                        ${statusText[h.status]}
                    </span>
                </div>
            `).join('');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', loadUserData);
    </script>

</body>
</html>
